!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).liquidjs={})}(this,function(p){"use strict";var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)};function t(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var x=function(){return(x=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function o(t,s,a,u){return new(a=a||Promise)(function(e,r){function n(t){try{o(u.next(t))}catch(t){r(t)}}function i(t){try{o(u.throw(t))}catch(t){r(t)}}function o(t){t.done?e(t.value):function(e){return e instanceof a?e:new a(function(t){t(e)})}(t.value).then(n,i)}o((u=u.apply(t,s||[])).next())})}function q(r,n){var i,o,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=n.call(r,a)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function O(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function m(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(n=o.next()).done;)s.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}function w(t,e,r){if(r||2===arguments.length)for(var n,i=0,o=e.length;i<o;i++)!n&&i in e||((n=n||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(n||Array.prototype.slice.call(e))}var s=(e.prototype.liquidMethodMissing=function(t){},e);function e(){}var r=Object.prototype.toString,i=String.prototype.toLowerCase,a=Object.hasOwnProperty;function u(t){return"string"==typeof t}function c(t){return"function"==typeof t}function l(t){return t&&c(t.next)&&c(t.throw)&&c(t.return)}function h(t){return u(t=f(t))?t:v(t)?"":g(t)?t.map(function(t){return h(t)}).join(""):String(t)}function f(t){return t instanceof s&&c(t.valueOf)?t.valueOf():t}function d(t){return"number"==typeof t}function v(t){return null==t}function g(t){return"[object Array]"===r.call(t)}function y(t,e){for(var r in t=t||{})if(a.call(t,r)&&!1===e(t[r],r,t))break;return t}function b(t){return t[t.length-1]}function T(t){var e=typeof t;return null!==t&&("object"==e||"function"==e)}function k(t,e,r){void 0===r&&(r=1);for(var n=[],i=t;i<e;i+=r)n.push(i);return n}function S(t,e,r){return void 0===r&&(r=" "),R(t,e,r,function(t,e){return e+t})}function R(t,e,r,n){for(var i=e-(t=String(t)).length;0<i--;)t=n(t,r);return t}function F(t){return t}function E(t){return t.replace(/(\w?)([A-Z])/g,function(t,e,r){return(e?e+"_":"")+r.toLowerCase()})}function L(t,e){return null==t&&null==e?0:null==t?1:null==e?-1:(t=i.call(t))<(e=i.call(e))?-1:e<t?1:0}function P(r){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r.apply(void 0,w([],m(t.map(f)),!1))}}function D(t){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}var M=function(t,e,r,n){this.key=t,this.value=e,this.next=r,this.prev=n},N=(_.prototype.write=function(t,e){if(this.cache[t])this.cache[t].value=e;else{var r=new M(t,e,this.head.next,this.head);this.head.next.prev=r,this.head.next=r,this.cache[t]=r,this.size++,this.ensureLimit()}},_.prototype.read=function(t){if(this.cache[t]){var e=this.cache[t].value;return this.remove(t),this.write(t,e),e}},_.prototype.remove=function(t){var e=this.cache[t];e.prev.next=e.next,e.next.prev=e.prev,delete this.cache[t],this.size--},_.prototype.clear=function(){this.head.next=this.tail,this.tail.prev=this.head,this.size=0,this.cache={}},_.prototype.ensureLimit=function(){this.size>this.limit&&this.remove(this.tail.prev.key)},_);function _(t,e){void 0===e&&(e=0),this.limit=t,this.size=e,this.cache={},this.head=new M("HEAD",null,null,null),this.tail=new M("TAIL",null,null,null),this.head.next=this.tail,this.tail.prev=this.head}function j(t,e){var r=document.createElement("base");r.href=t;var n=document.getElementsByTagName("head")[0];n.insertBefore(r,n.firstChild);var i=document.createElement("a");i.href=e;var o=i.href;return n.removeChild(r),o}var A=Object.freeze({__proto__:null,resolve:function(t,e,i){return t.length&&"/"!==b(t)&&(t+="/"),j(t,e).replace(/^(\w+:\/\/[^/]+)(\/[^?]+)/,function(t,e,r){var n=r.split("/").pop();return/\.\w+$/.test(n)?t:e+r+i})},readFile:function(n){return o(this,void 0,void 0,function(){return q(this,function(t){return[2,new Promise(function(t,e){var r=new XMLHttpRequest;r.onload=function(){200<=r.status&&r.status<300?t(r.responseText):e(new Error(r.statusText))},r.onerror=function(){e(new Error("An error occurred whilst receiving the response."))},r.open("GET",n),r.send()})]})})},readFileSync:function(t){var e=new XMLHttpRequest;if(e.open("GET",t,!1),e.send(),e.status<200||300<=e.status)throw new Error(e.statusText);return e.responseText},exists:function(t){return o(this,void 0,void 0,function(){return q(this,function(t){return[2,!0]})})},existsSync:function(t){return!0},dirname:function(t){return j(t,".")},sep:"/"});function I(t){return t&&c(t.equals)}function z(t,e){return!V(t,e)}function V(t,e){return e.opts.jsTruthy?!t:!1===t||null==t}var B={"==":function(t,e){return I(t)?t.equals(e):I(e)?e.equals(t):t===e},"!=":function(t,e){return I(t)?!t.equals(e):I(e)?!e.equals(t):t!==e},">":function(t,e){return I(t)?t.gt(e):I(e)?e.lt(t):e<t},"<":function(t,e){return I(t)?t.lt(e):I(e)?e.gt(t):t<e},">=":function(t,e){return I(t)?t.geq(e):I(e)?e.leq(t):e<=t},"<=":function(t,e){return I(t)?t.leq(e):I(e)?e.geq(t):t<=e},contains:function(t,e){return t=f(t),e=f(e),!(!t||!c(t.indexOf))&&-1<t.indexOf(e)},and:function(t,e,r){return z(t,r)&&z(e,r)},or:function(t,e,r){return z(t,r)||z(e,r)}},C=[0,0,0,0,0,0,0,0,0,20,4,4,4,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,2,8,0,0,0,0,8,0,0,0,64,0,65,0,0,33,33,33,33,33,33,33,33,33,33,0,0,2,2,2,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0],H=1,K=4,U=16;function Q(t){var e,r,n={};try{for(var i=O(Object.entries(t)),o=i.next();!o.done;o=i.next()){for(var s=m(o.value,2),a=s[0],u=s[1],c=n,l=0;l<a.length;l++){var h=a[l];c[h]=c[h]||{},l===a.length-1&&C[a.charCodeAt(l)]&H&&(c[h].needBoundary=!0),c=c[h]}c.handler=u,c.end=!0}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n}C[160]=C[5760]=C[6158]=C[8192]=C[8193]=C[8194]=C[8195]=C[8196]=C[8197]=C[8198]=C[8199]=C[8200]=C[8201]=C[8202]=C[8232]=C[8233]=C[8239]=C[8287]=C[12288]=K;var $={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},W={"&amp;":"&","&lt;":"<","&gt;":">","&#34;":'"',"&#39;":"'"};function Y(t){return h(t).replace(/&|<|>|"|'/g,function(t){return $[t]})}var J=P(Math.abs),G=P(Math.max),X=P(Math.min),Z=P(Math.ceil),tt=P(function(t,e,r){return void 0===r&&(r=!1),r?Math.floor(t/e):t/e}),et=P(Math.floor),rt=P(function(t,e){return t-e}),nt=P(function(t,e){return t%e}),it=P(function(t,e){return t*e});function ot(e){return g(e=f(e))?e:u(e)&&0<e.length?[e]:function(t){return T(t)&&Symbol.iterator in t}(e)?Array.from(e):T(e)?Object.keys(e).map(function(t){return[t,e[t]]}):[]}function st(t){return v(t)?[]:g(t)?t:[t]}var at=P(function(t,e){return st(t).join(void 0===e?" ":e)}),ut=P(function(t){return g(t)?b(t):""}),ct=P(function(t){return g(t)?t[0]:""}),lt=P(function(t){return w([],m(st(t)),!1).reverse()});var ht=/%([-_0^#:]+)?(\d+)?([EO])?(.)/,pt=["January","February","March","April","May","June","July","August","September","October","November","December"],ft=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dt=pt.map(yt),vt=ft.map(yt),gt={1:"st",2:"nd",3:"rd",default:"th"};function yt(t){return t.slice(0,3)}function mt(t){for(var e=0,r=0;r<t.getMonth();++r)e+=[31,function(t){var e=t.getFullYear();return!(0!=(3&e)||!(e%100||e%400==0&&e))}(t)?29:28,31,30,31,30,31,31,30,31,30,31][r];return e+t.getDate()}function wt(t,e){var r=mt(t)+(e-t.getDay()),n=7-new Date(t.getFullYear(),0,1).getDay()+e;return String(Math.floor((r-n)/7)+1)}var bt={d:2,e:2,H:2,I:2,j:3,k:2,l:2,L:3,m:2,M:2,S:2,U:2,W:2},Tt={a:" ",A:" ",b:" ",B:" ",c:" ",e:" ",k:" ",l:" ",p:" ",P:" "},kt={a:function(t){return vt[t.getDay()]},A:function(t){return ft[t.getDay()]},b:function(t){return dt[t.getMonth()]},B:function(t){return pt[t.getMonth()]},c:function(t){return t.toLocaleString()},C:function(t){return function(t){return parseInt(t.getFullYear().toString().substring(0,2),10)}(t)},d:function(t){return t.getDate()},e:function(t){return t.getDate()},H:function(t){return t.getHours()},I:function(t){return String(t.getHours()%12||12)},j:function(t){return mt(t)},k:function(t){return t.getHours()},l:function(t){return String(t.getHours()%12||12)},L:function(t){return t.getMilliseconds()},m:function(t){return t.getMonth()+1},M:function(t){return t.getMinutes()},N:function(t,e){var r=Number(e.width)||9;return function(t,e,r){return void 0===r&&(r=" "),R(t,e,r,function(t,e){return t+e})}(String(t.getMilliseconds()).substr(0,r),r,"0")},p:function(t){return t.getHours()<12?"AM":"PM"},P:function(t){return t.getHours()<12?"am":"pm"},q:function(t){return function(t){var e=t.getDate().toString(),r=parseInt(e.slice(-1));return gt[r]||gt.default}(t)},s:function(t){return Math.round(t.getTime()/1e3)},S:function(t){return t.getSeconds()},u:function(t){return t.getDay()||7},U:function(t){return wt(t,0)},w:function(t){return t.getDay()},W:function(t){return wt(t,1)},x:function(t){return t.toLocaleDateString()},X:function(t){return t.toLocaleTimeString()},y:function(t){return t.getFullYear().toString().substring(2,4)},Y:function(t){return t.getFullYear()},z:function(t,e){var r=Math.abs(t.getTimezoneOffset()),n=Math.floor(r/60),i=r%60;return(0<t.getTimezoneOffset()?"-":"+")+S(n,2,"0")+(e.flags[":"]?":":"")+S(i,2,"0")},t:function(){return"\t"},n:function(){return"\n"},"%":function(){return"%"}};function xt(t,e){var r,n,i=m(e,5),o=i[0],s=i[1],a=void 0===s?"":s,u=i[2],c=i[3],l=i[4],h=kt[l];if(!h)return o;var p={};try{for(var f=O(a),d=f.next();!d.done;d=f.next()){p[d.value]=!0}}catch(t){r={error:t}}finally{try{d&&!d.done&&(n=f.return)&&n.call(f)}finally{if(r)throw r.error}}var v=String(h(t,{flags:p,width:u,modifier:c})),g=Tt[l]||"0",y=u||bt[l]||0;return p["^"]?v=v.toUpperCase():p["#"]&&(v=function(t){return w([],m(t),!1).some(function(t){return"a"<=t&&t<="z"})?t.toUpperCase():t.toLowerCase()}(v)),p._?g=" ":p[0]&&(g="0"),p["-"]&&(y=0),S(v,y,g)}kt.h=kt.b;var qt=(new Date).getTimezoneOffset(),Ot=/([zZ]|([+-])(\d{2}):(\d{2}))$/,St=(Rt.prototype.getTime=function(){return this.date.getTime()},Rt.prototype.getMilliseconds=function(){return this.date.getMilliseconds()},Rt.prototype.getSeconds=function(){return this.date.getSeconds()},Rt.prototype.getMinutes=function(){return this.date.getMinutes()},Rt.prototype.getHours=function(){return this.date.getHours()},Rt.prototype.getDay=function(){return this.date.getDay()},Rt.prototype.getDate=function(){return this.date.getDate()},Rt.prototype.getMonth=function(){return this.date.getMonth()},Rt.prototype.getFullYear=function(){return this.date.getFullYear()},Rt.prototype.toLocaleTimeString=function(t){return this.date.toLocaleTimeString(t)},Rt.prototype.toLocaleDateString=function(t){return this.date.toLocaleDateString(t)},Rt.prototype.getTimezoneOffset=function(){return this.timezoneOffset},Rt.createDateFixedToTimezone=function(t){var e=t.match(Ot);if(e&&"Z"===e[1])return new Rt(+new Date(t),0);if(e&&e[2]&&e[3]&&e[4]){var r=m(e,5),n=r[2],i=r[3],o=r[4],s=("+"===n?-1:1)*(60*parseInt(i,10)+parseInt(o,10));return new Rt(+new Date(t),s)}return new Date(t)},Rt);function Rt(t,e){if(t instanceof Rt)this.date=t.date,e=t.timezoneOffset;else{var r=6e4*(qt-e),n=new Date(t).getTime()+r;this.date=new Date(n)}this.timezoneOffset=e}var Ft,Et=F,Lt=(t(Pt,Ft=Error),Pt.prototype.update=function(){var t=this.originalError;this.context=function(t){var i=m(t.getPosition(),1)[0],o=t.input.split("\n"),e=Math.max(i-2,1),s=Math.min(i+3,o.length);return k(e,s+1).map(function(t){var e=t===i?">> ":"   ",r=S(String(t),String(s).length),n=o[t-1];return"".concat(e).concat(r,"| ").concat(n)}).join("\n")}(this.token),this.message=function(t,e){e.file&&(t+=", file:".concat(e.file));var r=m(e.getPosition(),2),n=r[0],i=r[1];return t+=", line:".concat(n,", col:").concat(i)}(t.message,this.token),this.stack=this.message+"\n"+this.context+"\n"+this.stack+"\nFrom "+t.stack},Pt);function Pt(t,e){var r=Ft.call(this,t.message)||this;return r.originalError=t,r.token=e,r.context="",r}var Dt,Mt=(t(Nt,Dt=Lt),Nt);function Nt(t,e){var r=Dt.call(this,new Error(t),e)||this;return r.name="TokenizationError",Dt.prototype.update.call(r),r}var _t,jt=(t(At,_t=Lt),At);function At(t,e){var r=_t.call(this,t,e)||this;return r.name="ParseError",r.message=t.message,_t.prototype.update.call(r),r}var It,zt=(t(Vt,It=Lt),Vt.is=function(t){return"RenderError"===t.name},Vt);function Vt(t,e){var r=It.call(this,t,e.token)||this;return r.name="RenderError",r.message=t.message,It.prototype.update.call(r),r}var Bt,Ct=(t(Ht,Bt=Lt),Ht);function Ht(t,e){var r=Bt.call(this,t,e)||this;return r.name="UndefinedVariableError",r.message=t.message,Bt.prototype.update.call(r),r}var Kt,Ut=(t(Qt,Kt=Error),Qt);function Qt(t){var e=Kt.call(this,"undefined variable: ".concat(t))||this;return e.name="InternalUndefinedVariableError",e.variableName=t,e}var $t,Wt=(t(Yt,$t=Error),Yt);function Yt(t){var e=$t.call(this,t)||this;return e.name="AssertionError",e.message=t+"",e}function Jt(t,e){if(!t){var r="function"==typeof e?e():e||"expect ".concat(t," to be true");throw new Wt(r)}}var Gt,Xt=Object.freeze({__proto__:null,escape:Y,escapeOnce:function(t){return Y(function(t){return h(t).replace(/&(amp|lt|gt|#34|#39);/g,function(t){return W[t]})}(h(t)))},newlineToBr:function(t){return h(t).replace(/\n/g,"<br />\n")},stripHtml:function(t){return h(t).replace(/<script.*?<\/script>|<!--.*?-->|<style.*?<\/style>|<.*?>/g,"")},abs:J,atLeast:G,atMost:X,ceil:Z,dividedBy:tt,floor:et,minus:rt,modulo:nt,times:it,round:function(t,e){void 0===e&&(e=0),t=f(t),e=f(e);var r=Math.pow(10,e);return Math.round(t*r)/r},plus:function(t,e){return t=f(t),e=f(e),Number(t)+Number(e)},urlDecode:function(t){return h(t).split("+").map(decodeURIComponent).join(" ")},urlEncode:function(t){return h(t).split(" ").map(encodeURIComponent).join("+")},join:at,last:ut,first:ct,reverse:lt,sort:function(t,e){var r=this;function n(t){return e?r.context.getFromScope(t,h(e).split(".")):t}return w([],m(st(t=f(t))),!1).sort(function(t,e){return(t=n(t))<(e=n(e))?-1:e<t?1:0})},sortNatural:function(t,e){t=f(t);var r=h(e),n=void 0===e?L:function(t,e){return L(t[r],e[r])};return w([],m(st(t)),!1).sort(n)},size:function(t){return t&&t.length||0},map:function(t,e){var r=this;return st(t=f(t)).map(function(t){return r.context.getFromScope(t,h(e).split("."))})},compact:function(t){return st(t=f(t)).filter(function(t){return!v(f(t))})},concat:function(t,e){return void 0===e&&(e=[]),t=f(t),e=st(e).map(function(t){return f(t)}),st(t).concat(e)},slice:function(t,e,r){return void 0===r&&(r=1),v(t=f(t))?[]:(g(t)||(t=h(t)),e=e<0?t.length+e:e,t.slice(e,e+r))},where:function(t,r,n){var i=this;return st(t=f(t)).filter(function(t){var e=i.context.getFromScope(t,h(r).split("."));return void 0===n?z(e,i.context):I(n)?n.equals(e):e===n})},uniq:function(t){t=f(t);var e={};return(t||[]).filter(function(t){return!a.call(e,String(t))&&(e[String(t)]=!0)})},date:function(t,e){var r,n=this.context.opts;return t=f(t),e=h(e),function(t){return(t instanceof Date||t instanceof St)&&!isNaN(t.getTime())}(r="now"===t||"today"===t?new Date:d(t)?new Date(1e3*t):u(t)?/^\d+$/.test(t)?new Date(1e3*+t):n.preserveTimezones?St.createDateFixedToTimezone(t):new Date(t):t)?(n.hasOwnProperty("timezoneOffset")&&(r=new St(r,n.timezoneOffset)),function(t,e){for(var r,n="",i=e;r=ht.exec(i);)n+=i.slice(0,r.index),i=i.slice(r.index+r[0].length),n+=xt(t,r);return n+i}(r,e)):t},Default:function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return g(t=f(t))||u(t)?t.length?t:e:(!1!==t||!new Map(r).get("allow_false"))&&(V(t,this.context)?e:t)},json:function(t){return JSON.stringify(t)},raw:Et,append:function(t,e){return Jt(2===arguments.length,"append expect 2 arguments"),h(t)+h(e)},prepend:function(t,e){return Jt(2===arguments.length,"prepend expect 2 arguments"),h(e)+h(t)},lstrip:function(t,e){return e?(e=D(h(e)),h(t).replace(new RegExp("^[".concat(e,"]+"),"g"),"")):h(t).replace(/^\s+/,"")},downcase:function(t){return h(t).toLowerCase()},upcase:function(t){return h(t).toUpperCase()},remove:function(t,e){return h(t).split(String(e)).join("")},removeFirst:function(t,e){return h(t).replace(String(e),"")},rstrip:function(t,e){return e?(e=D(h(e)),h(t).replace(new RegExp("[".concat(e,"]+$"),"g"),"")):h(t).replace(/\s+$/,"")},split:function(t,e){for(var r=h(t).split(String(e));r.length&&""===r[r.length-1];)r.pop();return r},strip:function(t,e){return e?(e=D(h(e)),h(t).replace(new RegExp("^[".concat(e,"]+"),"g"),"").replace(new RegExp("[".concat(e,"]+$"),"g"),"")):h(t).trim()},stripNewlines:function(t){return h(t).replace(/\n/g,"")},capitalize:function(t){return(t=h(t)).charAt(0).toUpperCase()+t.slice(1).toLowerCase()},replace:function(t,e,r){return h(t).split(String(e)).join(r)},replaceFirst:function(t,e,r){return h(t).replace(String(e),r)},truncate:function(t,e,r){return void 0===e&&(e=50),void 0===r&&(r="..."),(t=h(t)).length<=e?t:t.substring(0,e-r.length)+r},truncatewords:function(t,e,r){void 0===e&&(e=15),void 0===r&&(r="...");var n=h(t).split(/\s+/),i=n.slice(0,e).join(" ");return n.length>=e&&(i+=r),i}});function Zt(t){return!!(le(t)&p.TokenKind.Delimited)}function te(t){return le(t)===p.TokenKind.Operator}function ee(t){return le(t)===p.TokenKind.HTML}function re(t){return le(t)===p.TokenKind.Output}function ne(t){return le(t)===p.TokenKind.Tag}function ie(t){return le(t)===p.TokenKind.Quoted}function oe(t){return le(t)===p.TokenKind.Literal}function se(t){return le(t)===p.TokenKind.Number}function ae(t){return le(t)===p.TokenKind.PropertyAccess}function ue(t){return le(t)===p.TokenKind.Word}function ce(t){return le(t)===p.TokenKind.Range}function le(t){return t?t.kind:-1}p.TokenKind=void 0,(Gt=p.TokenKind||(p.TokenKind={}))[Gt.Number=1]="Number",Gt[Gt.Literal=2]="Literal",Gt[Gt.Tag=4]="Tag",Gt[Gt.Output=8]="Output",Gt[Gt.HTML=16]="HTML",Gt[Gt.Filter=32]="Filter",Gt[Gt.Hash=64]="Hash",Gt[Gt.PropertyAccess=128]="PropertyAccess",Gt[Gt.Word=256]="Word",Gt[Gt.Range=512]="Range",Gt[Gt.Quoted=1024]="Quoted",Gt[Gt.Operator=2048]="Operator",Gt[Gt.Delimited=12]="Delimited";var he,pe=Object.freeze({__proto__:null,isDelimitedToken:Zt,isOperatorToken:te,isHTMLToken:ee,isOutputToken:re,isTagToken:ne,isQuotedToken:ie,isLiteralToken:oe,isNumberToken:se,isPropertyAccessToken:ae,isWordToken:ue,isRangeToken:ce}),fe=(t(de,he=s),de.prototype.equals=function(t){return v(f(t))},de.prototype.gt=function(){return!1},de.prototype.geq=function(){return!1},de.prototype.lt=function(){return!1},de.prototype.leq=function(){return!1},de.prototype.valueOf=function(){return null},de);function de(){return null!==he&&he.apply(this,arguments)||this}var ve,ge=(t(ye,ve=s),ye.prototype.equals=function(t){return!(t instanceof ye||(u(t=f(t))||g(t)?0!==t.length:!T(t)||0!==Object.keys(t).length))},ye.prototype.gt=function(){return!1},ye.prototype.geq=function(){return!1},ye.prototype.lt=function(){return!1},ye.prototype.leq=function(){return!1},ye.prototype.valueOf=function(){return""},ye);function ye(){return null!==ve&&ve.apply(this,arguments)||this}var me,we=(t(be,me=ge),be.prototype.equals=function(t){return!1===t||!!v(f(t))||(u(t)?/^\s*$/.test(t):me.prototype.equals.call(this,t))},be);function be(){return null!==me&&me.apply(this,arguments)||this}var Te=new fe,ke={true:!0,false:!1,nil:Te,null:Te,empty:new ge,blank:new we},xe=/[\da-fA-F]/,qe=/[0-7]/,Oe={b:"\b",f:"\f",n:"\n",r:"\r",t:"\t",v:"\v"};function Se(t){var e=t.charCodeAt(0);return 97<=e?e-87:65<=e?e-55:e-48}function Re(t){for(var e="",r=1;r<t.length-1;r++)if("\\"===t[r])if(void 0!==Oe[t[r+1]])e+=Oe[t[++r]];else if("u"===t[r+1]){for(var n=0,i=r+2;i<=r+5&&xe.test(t[i]);)n=16*n+Se(t[i++]);r=i-1,e+=String.fromCharCode(n)}else if(qe.test(t[r+1])){for(i=r+1,n=0;i<=r+3&&qe.test(t[i]);)n=8*n+Se(t[i++]);r=i-1,e+=String.fromCharCode(n)}else e+=t[++r];else e+=t[r];return e}var Fe=(Ee.prototype.evaluate=function(e,r){var n,i,o,s,a,u,c,l,h,p,f,d;return q(this,function(t){switch(t.label){case 0:Jt(e,"unable to evaluate: context not defined"),n=[],t.label=1;case 1:t.trys.push([1,8,9,10]),i=O(this.postfix),o=i.next(),t.label=2;case 2:return o.done?[3,7]:te(s=o.value)?(a=n.pop(),u=n.pop(),[4,function(t,e,r,n,i){return(0,t[e.operator])(r,n,i)}(e.opts.operators,s,u,a,e)]):[3,4];case 3:return c=t.sent(),n.push(c),[3,6];case 4:return h=(l=n).push,[4,Le(s,e,r&&1===this.postfix.length)];case 5:h.apply(l,[t.sent()]),t.label=6;case 6:return o=i.next(),[3,2];case 7:return[3,10];case 8:return p=t.sent(),f={error:p},[3,10];case 9:try{o&&!o.done&&(d=i.return)&&d.call(i)}finally{if(f)throw f.error}return[7];case 10:return[2,n[0]]}})},Ee);function Ee(t){this.postfix=w([],m(function(e){var r,n,i,o,s,a,u;return q(this,function(t){switch(t.label){case 0:r=[],t.label=1;case 1:t.trys.push([1,10,11,12]),n=O(e),i=n.next(),t.label=2;case 2:if(i.done)return[3,9];if(!te(o=i.value))return[3,6];t.label=3;case 3:return r.length&&r[r.length-1].getPrecedence()>o.getPrecedence()?[4,r.pop()]:[3,5];case 4:return t.sent(),[3,3];case 5:return r.push(o),[3,8];case 6:return[4,o];case 7:t.sent(),t.label=8;case 8:return i=n.next(),[3,2];case 9:return[3,12];case 10:return s=t.sent(),a={error:s},[3,12];case 11:try{i&&!i.done&&(u=n.return)&&u.call(n)}finally{if(a)throw a.error}return[7];case 12:return r.length?[4,r.pop()]:[3,14];case 13:return t.sent(),[3,12];case 14:return[2]}})}(t)),!1)}function Le(t,e,r){return void 0===r&&(r=!1),ae(t)?function(e,r,n){var t=e.props.map(function(t){return Le(t,r,!1)});try{return r.get(w([e.propertyName],m(t),!1))}catch(t){if(n&&"InternalUndefinedVariableError"===t.name)return null;throw new Ct(t,e)}}(t,e,r):ce(t)?function(t,e){var r=Le(t.lhs,e),n=Le(t.rhs,e);return k(+r,+n+1)}(t,e):oe(t)?function(t){return ke[t.literal]}(t):se(t)?function(t){var e=t.whole.content+"."+(t.decimal?t.decimal.content:"");return Number(e)}(t):ue(t)?t.getText():ie(t)?Pe(t):void 0}function Pe(t){return Re(t.getText())}var De=(Me.prototype.getText=function(){return this.input.slice(this.begin,this.end)},Me.prototype.getPosition=function(){for(var t=m([1,1],2),e=t[0],r=t[1],n=0;n<this.begin;n++)"\n"===this.input[n]?(e++,r=1):r++;return[e,r]},Me.prototype.size=function(){return this.end-this.begin},Me);function Me(t,e,r,n,i){this.kind=t,this.input=e,this.begin=r,this.end=n,this.file=i}var Ne,_e=(t(je,Ne=De),je);function je(t,e,r,n,i,o,s,a){var u=Ne.call(this,t,r,n,i,a)||this;u.trimLeft=!1,u.trimRight=!1,u.content=u.getText();var c="-"===e[0],l="-"===b(e);return u.content=e.slice(c?1:0,l?-1:e.length).trim(),u.trimLeft=c||o,u.trimRight=l||s,u}function Ae(t,e){if(t&&ee(t))for(var r=e?K:U;C[t.input.charCodeAt(t.end-1-t.trimRight)]&r;)t.trimRight++}function Ie(t,e){if(t&&ee(t)){for(var r=e?K:U;C[t.input.charCodeAt(t.begin+t.trimLeft)]&r;)t.trimLeft++;"\n"===t.input.charAt(t.begin+t.trimLeft)&&t.trimLeft++}}var ze,Ve=(t(Be,ze=De),Be);function Be(t,e){var r=ze.call(this,p.TokenKind.Number,t.input,t.begin,e?e.end:t.end,t.file)||this;return r.whole=t,r.decimal=e,r}var Ce,He=(t(Ke,Ce=De),Ke.prototype.isNumber=function(t){void 0===t&&(t=!1);for(var e=t&&64&C[this.input.charCodeAt(this.begin)]?this.begin+1:this.begin;e<this.end;e++)if(!(32&C[this.input.charCodeAt(e)]))return!1;return!0},Ke);function Ke(t,e,r,n){var i=Ce.call(this,p.TokenKind.Word,t,e,r,n)||this;return i.input=t,i.begin=e,i.end=r,i.file=n,i.content=i.getText(),i}var Ue,Qe=(t($e,Ue=De),$e);function $e(t,e,r,n){var i=Ue.call(this,p.TokenKind.Literal,t,e,r,n)||this;return i.input=t,i.begin=e,i.end=r,i.file=n,i.literal=i.getText(),i}var We,Ye={"==":1,"!=":1,">":1,"<":1,">=":1,"<=":1,contains:1,and:0,or:0},Je=(t(Ge,We=De),Ge.prototype.getPrecedence=function(){var t=this.getText();return t in Ye?Ye[t]:1},Ge);function Ge(t,e,r,n){var i=We.call(this,p.TokenKind.Operator,t,e,r,n)||this;return i.input=t,i.begin=e,i.end=r,i.file=n,i.operator=i.getText(),i}var Xe,Ze=(t(tr,Xe=De),tr);function tr(t,e,r){var n=Xe.call(this,p.TokenKind.PropertyAccess,t.input,t.begin,r,t.file)||this;return n.variable=t,n.props=e,n.propertyName=n.variable instanceof He?n.variable.getText():Re(n.variable.getText()),n}var er,rr=(t(nr,er=De),nr);function nr(t,e,r,n,i,o){var s=er.call(this,p.TokenKind.Filter,r,n,i,o)||this;return s.name=t,s.args=e,s}var ir,or=(t(sr,ir=De),sr);function sr(t,e,r,n,i,o){var s=ir.call(this,p.TokenKind.Hash,t,e,r,o)||this;return s.input=t,s.begin=e,s.end=r,s.name=n,s.value=i,s.file=o,s}var ar,ur=(t(cr,ar=De),cr);function cr(t,e,r,n){var i=ar.call(this,p.TokenKind.Quoted,t,e,r,n)||this;return i.input=t,i.begin=e,i.end=r,i.file=n,i}var lr,hr=(t(pr,lr=De),pr.prototype.getContent=function(){return this.input.slice(this.begin+this.trimLeft,this.end-this.trimRight)},pr);function pr(t,e,r,n){var i=lr.call(this,p.TokenKind.HTML,t,e,r,n)||this;return i.input=t,i.begin=e,i.end=r,i.file=n,i.trimLeft=0,i.trimRight=0,i}var fr,dr=(t(vr,fr=De),vr);function vr(t,e,r,n,i,o){var s=fr.call(this,p.TokenKind.Range,t,e,r,o)||this;return s.input=t,s.begin=e,s.end=r,s.lhs=n,s.rhs=i,s.file=o,s}var gr,yr=(t(mr,gr=_e),mr);function mr(t,e,r,n,i){var o=n.trimOutputLeft,s=n.trimOutputRight,a=n.outputDelimiterLeft,u=n.outputDelimiterRight,c=t.slice(e+a.length,r-u.length);return gr.call(this,p.TokenKind.Output,c,t,e,r,o,s,i)||this}var wr,br=(t(Tr,wr=_e),Tr);function Tr(t,e,r,n,i){var o=this,s=t.slice(e,r);if(o=wr.call(this,p.TokenKind.Tag,s,t,e,r,!1,!1,i)||this,/\S/.test(s)){var a=new kr(o.content,n.operatorsTrie);if(o.name=a.readTagName(),!o.name)throw new Mt("illegal liquid tag syntax",o);a.skipBlank(),o.args=a.remaining()}else o.name="",o.args="";return o}var kr=(xr.prototype.readExpression=function(){return new Fe(this.readExpressionTokens())},xr.prototype.readExpressionTokens=function(){var e,r,n;return q(this,function(t){switch(t.label){case 0:return(e=this.readValue())?[4,e]:[2];case 1:t.sent(),t.label=2;case 2:return this.p<this.N?(r=this.readOperator())&&(n=this.readValue())?[4,r]:[2]:[3,5];case 3:return t.sent(),[4,n];case 4:return t.sent(),[3,2];case 5:return[2]}})},xr.prototype.readOperator=function(){this.skipBlank();var t=function(t,e,r,n){void 0===n&&(n=t.length);for(var i,o=r,s=e;o[t[s]]&&s<n;)(o=o[t[s++]]).end&&(i=o);return i?i.needBoundary&&C[t.charCodeAt(s)]&H?-1:s:-1}(this.input,this.p,this.trie);if(-1!==t)return new Je(this.input,this.p,this.p=t,this.file)},xr.prototype.readFilters=function(){for(var t=[];;){var e=this.readFilter();if(!e)return t;t.push(e)}},xr.prototype.readFilter=function(){var t=this;if(this.skipBlank(),this.end())return null;Jt("|"===this.peek(),function(){return"unexpected token at ".concat(t.snapshot())}),this.p++;var e=this.p,r=this.readIdentifier();if(!r.size())return null;var n=[];if(this.skipBlank(),":"===this.peek())do{++this.p;var i=this.readFilterArg();i&&n.push(i),this.skipBlank(),Jt(this.end()||","===this.peek()||"|"===this.peek(),function(){return"unexpected character ".concat(t.snapshot())})}while(","===this.peek());return new rr(r.getText(),n,this.input,e,this.p,this.file)},xr.prototype.readFilterArg=function(){var t=this.readValue();if(t){if(this.skipBlank(),":"!==this.peek())return t;++this.p;var e=this.readValue();return[t.getText(),e]}},xr.prototype.readTopLevelTokens=function(t){void 0===t&&(t=mn);for(var e=[];this.p<this.N;){var r=this.readTopLevelToken(t);e.push(r)}return function(t,e){for(var r=!1,n=0;n<t.length;n++){var i=t[n];Zt(i)&&(!r&&i.trimLeft&&Ae(t[n-1],e.greedy),ne(i)&&("raw"===i.name?r=!0:"endraw"===i.name&&(r=!1)),!r&&i.trimRight&&Ie(t[n+1],e.greedy))}}(e,t),e},xr.prototype.readTopLevelToken=function(t){var e=t.tagDelimiterLeft,r=t.outputDelimiterLeft;return-1<this.rawBeginAt?this.readEndrawOrRawContent(t):this.match(e)?this.readTagToken(t):this.match(r)?this.readOutputToken(t):this.readHTMLToken([e,r])},xr.prototype.readHTMLToken=function(t){for(var e=this,r=this.p;this.p<this.N&&!t.some(function(t){return e.match(t)});)++this.p;return new hr(this.input,r,this.p,this.file)},xr.prototype.readTagToken=function(t){void 0===t&&(t=mn);var e=this.file,r=this.input,n=this.p;if(-1===this.readToDelimiter(t.tagDelimiterRight))throw this.mkError("tag ".concat(this.snapshot(n)," not closed"),n);var i=new Or(r,n,this.p,t,e);return"raw"===i.name&&(this.rawBeginAt=n),i},xr.prototype.readToDelimiter=function(t){for(;this.p<this.N;)if(8&this.peekType())this.readQuoted();else if(++this.p,this.rmatch(t))return this.p;return-1},xr.prototype.readOutputToken=function(t){void 0===t&&(t=mn);var e=this.file,r=this.input,n=t.outputDelimiterRight,i=this.p;if(-1===this.readToDelimiter(n))throw this.mkError("output ".concat(this.snapshot(i)," not closed"),i);return new yr(r,i,this.p,t,e)},xr.prototype.readEndrawOrRawContent=function(t){for(var e=t.tagDelimiterLeft,r=t.tagDelimiterRight,n=this.p,i=this.readTo(e)-e.length;this.p<this.N;)if("endraw"===this.readIdentifier().getText())for(;this.p<=this.N;){if(this.rmatch(r)){var o=this.p;return n===i?(this.rawBeginAt=-1,new Or(this.input,n,o,t,this.file)):(this.p=i,new hr(this.input,n,i,this.file))}if(this.rmatch(e))break;this.p++}else i=this.readTo(e)-e.length;throw this.mkError("raw ".concat(this.snapshot(this.rawBeginAt)," not closed"),n)},xr.prototype.readLiquidTagTokens=function(t){void 0===t&&(t=mn);for(var e=[];this.p<this.N;){var r=this.readLiquidTagToken(t);r.name&&e.push(r)}return e},xr.prototype.readLiquidTagToken=function(t){var e=this.file,r=this.input,n=this.p,i=this.N;return-1!==this.readToDelimiter("\n")&&(i=this.p),new br(r,n,i,t,e)},xr.prototype.mkError=function(t,e){return new Mt(t,new He(this.input,e,this.N,this.file))},xr.prototype.snapshot=function(t){return void 0===t&&(t=this.p),JSON.stringify(function(t,e){return t.length>e?t.substr(0,e-3)+"...":t}(this.input.slice(t),16))},xr.prototype.readWord=function(){return console.warn("Tokenizer#readWord() will be removed, use #readIdentifier instead"),this.readIdentifier()},xr.prototype.readIdentifier=function(){this.skipBlank();for(var t=this.p;this.peekType()&H;)++this.p;return new He(this.input,t,this.p,this.file)},xr.prototype.readTagName=function(){return this.skipBlank(),"#"===this.input[this.p]?this.input.slice(this.p,++this.p):this.readIdentifier().getText()},xr.prototype.readHashes=function(t){for(var e=[];;){var r=this.readHash(t);if(!r)return e;e.push(r)}},xr.prototype.readHash=function(t){this.skipBlank(),","===this.peek()&&++this.p;var e=this.p,r=this.readIdentifier();if(r.size()){var n;this.skipBlank();var i=t?"=":":";return this.peek()===i&&(++this.p,n=this.readValue()),new or(this.input,e,this.p,r,n,this.file)}},xr.prototype.remaining=function(){return this.input.slice(this.p)},xr.prototype.advance=function(t){void 0===t&&(t=1),this.p+=t},xr.prototype.end=function(){return this.p>=this.N},xr.prototype.readTo=function(t){for(;this.p<this.N;)if(++this.p,this.rmatch(t))return this.p;return-1},xr.prototype.readValue=function(){var t=this.readQuoted()||this.readRange();if(t)return t;if("["===this.peek()){if(this.p++,!(i=this.readQuoted()))return;if("]"!==this.peek())return;return this.p++,new Ze(i,[],this.p)}var e=this.readIdentifier();if(e.size()){for(var r=e.isNumber(!0),n=[];;)if("["===this.peek()){r=!1,this.p++;var i=this.readValue()||new He(this.input,this.p,this.p,this.file);this.readTo("]"),n.push(i)}else{if("."!==this.peek()||"."===this.peek(1))break;if(this.p++,!(i=this.readIdentifier()).size())break;i.isNumber()||(r=!1),n.push(i)}return!n.length&&ke.hasOwnProperty(e.content)?new Qe(this.input,e.begin,e.end,this.file):r?new Ve(e,n[0]):new Ze(e,n,this.p)}},xr.prototype.readRange=function(){this.skipBlank();var t=this.p;if("("===this.peek()){++this.p;var e=this.readValueOrThrow();this.p+=2;var r=this.readValueOrThrow();return++this.p,new dr(this.input,t,this.p,e,r,this.file)}},xr.prototype.readValueOrThrow=function(){var t=this,e=this.readValue();return Jt(e,function(){return"unexpected token ".concat(t.snapshot(),", value expected")}),e},xr.prototype.readQuoted=function(){this.skipBlank();var t=this.p;if(8&this.peekType()){++this.p;for(var e=!1;this.p<this.N&&(++this.p,this.input[this.p-1]!==this.input[t]||e);)e?e=!1:"\\"===this.input[this.p-1]&&(e=!0);return new ur(this.input,t,this.p,this.file)}},xr.prototype.readFileNameTemplate=function(e){var r,n,i;return q(this,function(t){switch(t.label){case 0:r=e.outputDelimiterLeft,n=[","," ",r],i=new Set(n),t.label=1;case 1:return this.p<this.N&&!i.has(this.peek())?[4,this.match(r)?this.readOutputToken(e):this.readHTMLToken(n)]:[3,3];case 2:return t.sent(),[3,1];case 3:return[2]}})},xr.prototype.match=function(t){for(var e=0;e<t.length;e++)if(t[e]!==this.input[this.p+e])return!1;return!0},xr.prototype.rmatch=function(t){for(var e=0;e<t.length;e++)if(t[t.length-1-e]!==this.input[this.p-1-e])return!1;return!0},xr.prototype.peekType=function(t){return void 0===t&&(t=0),C[this.input.charCodeAt(this.p+t)]},xr.prototype.peek=function(t){return void 0===t&&(t=0),this.input[this.p+t]},xr.prototype.skipBlank=function(){for(;this.peekType()&K;)++this.p},xr);function xr(t,e,r){void 0===r&&(r=""),this.input=t,this.trie=e,this.file=r,this.p=0,this.rawBeginAt=-1,this.N=t.length}var qr,Or=(t(Sr,qr=_e),Sr);function Sr(t,e,r,n,i){var o=this,s=n.trimTagLeft,a=n.trimTagRight,u=n.tagDelimiterLeft,c=n.tagDelimiterRight,l=t.slice(e+u.length,r-c.length);o=qr.call(this,p.TokenKind.Tag,l,t,e,r,s,a,i)||this;var h=new kr(o.content,n.operatorsTrie);if(o.name=h.readTagName(),!o.name)throw new Mt("illegal tag syntax",o);return h.skipBlank(),o.args=h.remaining(),o}var Rr=(Fr.prototype.on=function(t,e){return this.handlers[t]=e,this},Fr.prototype.trigger=function(t,e){var r=this.handlers[t];return!!r&&(r.call(this,e),!0)},Fr.prototype.start=function(){var t;for(this.trigger("start");!this.stopRequested&&(t=this.tokens.shift());)if(!(this.trigger("token",t)||ne(t)&&this.trigger("tag:".concat(t.name),t))){var e=this.parseToken(t,this.tokens);this.trigger("template",e)}return this.stopRequested||this.trigger("end"),this},Fr.prototype.stop=function(){return this.stopRequested=!0,this},Fr);function Fr(t,e){this.handlers={},this.stopRequested=!1,this.tokens=t,this.parseToken=e}var Er=(Lr.prototype.render=function(e){var r,n,i,o,s,a,u,c,l,h;return q(this,function(t){switch(t.label){case 0:r={},t.label=1;case 1:t.trys.push([1,8,9,10]),n=O(Object.keys(this.hash)),i=n.next(),t.label=2;case 2:return i.done?[3,7]:(o=i.value,s=r,a=o,void 0!==this.hash[o]?[3,3]:(u=!0,[3,5]));case 3:return[4,Le(this.hash[o],e)];case 4:u=t.sent(),t.label=5;case 5:s[a]=u,t.label=6;case 6:return i=n.next(),[3,2];case 7:return[3,10];case 8:return c=t.sent(),l={error:c},[3,10];case 9:try{i&&!i.done&&(h=n.return)&&h.call(n)}finally{if(l)throw l.error}return[7];case 10:return[2,r]}})},Lr);function Lr(t,e){var r,n;this.hash={};var i=new kr(t,{});try{for(var o=O(i.readHashes(e)),s=o.next();!s.done;s=o.next()){var a=s.value;this.hash[a.name.content]=a.value}}catch(t){r={error:t}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}}var Pr=(Dr.prototype.render=function(t,e){var r,n,i=[];try{for(var o=O(this.args),s=o.next();!s.done;s=o.next()){var a=s.value;g(a)?i.push([a[0],Le(a[1],e)]):i.push(Le(a,e))}}catch(t){r={error:t}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return this.impl.apply({context:e,liquid:this.liquid},w([t],m(i),!1))},Dr);function Dr(t,e,r,n){this.name=t,this.impl=e||F,this.args=r,this.liquid=n}var Mr=(Nr.prototype.value=function(e,r){var n,i,o,s,a,u;return q(this,function(t){switch(t.label){case 0:return r=r||e.opts.lenientIf&&0<this.filters.length&&"default"===this.filters[0].name,[4,this.initial.evaluate(e,r)];case 1:n=t.sent(),t.label=2;case 2:t.trys.push([2,7,8,9]),i=O(this.filters),o=i.next(),t.label=3;case 3:return o.done?[3,6]:[4,o.value.render(n,e)];case 4:n=t.sent(),t.label=5;case 5:return o=i.next(),[3,3];case 6:return[3,9];case 7:return s=t.sent(),a={error:s},[3,9];case 8:try{o&&!o.done&&(u=i.return)&&u.call(i)}finally{if(a)throw a.error}return[7];case 9:return[2,n]}})},Nr);function Nr(t,n){this.filters=[];var e=new kr(t,n.options.operatorsTrie);this.initial=e.readExpression(),this.filters=e.readFilters().map(function(t){var e=t.name,r=t.args;return new Pr(e,n.filters.get(e),r,n)})}function _r(s){return o(this,void 0,void 0,function(){var e,r,n,i,o;return q(this,function(t){switch(t.label){case 0:if(!l(s))return[2,s];r=!1,n="next",t.label=1;case 1:i=s[n](e),r=i.done,e=i.value,n="next",t.label=2;case 2:return t.trys.push([2,5,,6]),l(e)&&(e=_r(e)),function(t){return t&&c(t.then)}(e)?[4,e]:[3,4];case 3:e=t.sent(),t.label=4;case 4:return[3,6];case 5:return o=t.sent(),n="throw",e=o,[3,6];case 6:if(!r)return[3,1];t.label=7;case 7:return[2,e]}})})}function jr(t){if(!l(t))return t;var e,r=!1,n="next";do{var i=t[n](e);if(r=i.done,n="next",l(e=i.value))try{e=jr(e)}catch(t){n="throw",e=t}}while(!r);return e}var Ar,Ir=_r,zr={parse:function(t){var e=new kr(t.args,this.liquid.options.operatorsTrie);this.key=e.readIdentifier().content,e.skipBlank(),Jt("="===e.peek(),function(){return"illegal token ".concat(t.getText())}),e.advance(),this.value=new Mr(e.remaining(),this.liquid)},render:function(e){var r,n;return q(this,function(t){switch(t.label){case 0:return r=e.bottom(),n=this.key,[4,this.value.value(e,this.liquid.options.lenientIf)];case 1:return r[n]=t.sent(),[2]}})}},Vr=(t(Br,Ar=s),Br.prototype.next=function(){this.i++},Br.prototype.index0=function(){return this.i},Br.prototype.index=function(){return this.i+1},Br.prototype.first=function(){return 0===this.i},Br.prototype.last=function(){return this.i===this.length-1},Br.prototype.rindex=function(){return this.length-this.i},Br.prototype.rindex0=function(){return this.length-this.i-1},Br.prototype.valueOf=function(){return JSON.stringify(this)},Br);function Br(t,e,r){var n=Ar.call(this)||this;return n.i=0,n.length=t,n.name="".concat(r,"-").concat(e),n}var Cr=["offset","limit","reversed"],Hr={type:"block",parse:function(t,e){var r,n=this,i=new kr(t.args,this.liquid.options.operatorsTrie),o=i.readIdentifier(),s=i.readIdentifier(),a=i.readValue();Jt(o.size()&&"in"===s.content&&a,function(){return"illegal tag: ".concat(t.getText())}),this.variable=o.content,this.collection=a,this.hash=new Er(i.remaining()),this.templates=[],this.elseTemplates=[];var u=this.liquid.parser.parseStream(e).on("start",function(){return r=n.templates}).on("tag:else",function(){return r=n.elseTemplates}).on("tag:endfor",function(){return u.stop()}).on("template",function(t){return r.push(t)}).on("end",function(){throw new Error("tag ".concat(t.getText()," not closed"))});u.start()},render:function(e,r){var n,i,o,s,a,u,c,l,h,p,f,d,v;return q(this,function(t){switch(t.label){case 0:return n=this.liquid.renderer,o=ot,[4,Le(this.collection,e)];case 1:return(i=o.apply(void 0,[t.sent()])).length?[3,3]:[4,n.renderTemplates(this.elseTemplates,e,r)];case 2:return t.sent(),[2];case 3:return s="continue-"+this.variable+"-"+this.collection.getText(),e.push({continue:e.getRegister(s)}),[4,this.hash.render(e)];case 4:a=t.sent(),e.pop(),u=this.liquid.options.orderedFilterParameters?Object.keys(a).filter(function(t){return Cr.includes(t)}):Cr.filter(function(t){return void 0!==a[t]}),i=u.reduce(function(t,e){return"offset"===e?function(t,e){return t.slice(e)}(t,a.offset):"limit"===e?function(t,e){return t.slice(0,e)}(t,a.limit):function(t){return w([],m(t),!1).reverse()}(t)},i),e.setRegister(s,(a.offset||0)+i.length),c={forloop:new Vr(i.length,this.collection.getText(),this.variable)},e.push(c),t.label=5;case 5:t.trys.push([5,10,11,12]),l=O(i),h=l.next(),t.label=6;case 6:return h.done?[3,9]:(p=h.value,c[this.variable]=p,[4,n.renderTemplates(this.templates,e,r)]);case 7:if(t.sent(),r.break)return r.break=!1,[3,9];r.continue=!1,c.forloop.next(),t.label=8;case 8:return h=l.next(),[3,6];case 9:return[3,12];case 10:return f=t.sent(),d={error:f},[3,12];case 11:try{h&&!h.done&&(v=l.return)&&v.call(l)}finally{if(d)throw d.error}return[7];case 12:return e.pop(),[2]}})}};var Kr={parse:function(t,e){var r=this,n=new kr(t.args,this.liquid.options.operatorsTrie);this.variable=function(t){var e=t.readIdentifier().content;if(e)return e;var r=t.readQuoted();if(r)return Pe(r)}(n),Jt(this.variable,function(){return"".concat(t.args," not valid identifier")}),this.templates=[];var i=this.liquid.parser.parseStream(e);i.on("tag:endcapture",function(){return i.stop()}).on("template",function(t){return r.templates.push(t)}).on("end",function(){throw new Error("tag ".concat(t.getText()," not closed"))}),i.start()},render:function(e){var r;return q(this,function(t){switch(t.label){case 0:return[4,this.liquid.renderer.renderTemplates(this.templates,e)];case 1:return r=t.sent(),e.bottom()[this.variable]=r,[2]}})}};var Ur,Qr,$r={parse:function(t,e){var n=this;this.cond=new Mr(t.args,this.liquid),this.cases=[],this.elseTemplates=[];var i=[],r=this.liquid.parser.parseStream(e).on("tag:when",function(t){i=[];for(var e=new kr(t.args,n.liquid.options.operatorsTrie);!e.end();){var r=e.readValue();n.cases.push({val:r,templates:i}),e.readTo(",")}}).on("tag:else",function(){return i=n.elseTemplates}).on("tag:endcase",function(){return r.stop()}).on("template",function(t){return i.push(t)}).on("end",function(){throw new Error("tag ".concat(t.getText()," not closed"))});r.start()},render:function(e,r){var n,i,o,s,a,u,c,l,h;return q(this,function(t){switch(t.label){case 0:return n=this.liquid.renderer,o=f,[4,this.cond.value(e,e.opts.lenientIf)];case 1:i=o.apply(void 0,[t.sent()]),t.label=2;case 2:t.trys.push([2,7,8,9]),s=O(this.cases),a=s.next(),t.label=3;case 3:return a.done?[3,6]:(u=a.value,Le(u.val,e,e.opts.lenientIf)!==i?[3,5]:[4,n.renderTemplates(u.templates,e,r)]);case 4:return t.sent(),[2];case 5:return a=s.next(),[3,3];case 6:return[3,9];case 7:return c=t.sent(),l={error:c},[3,9];case 8:try{a&&!a.done&&(h=s.return)&&h.call(s)}finally{if(l)throw l.error}return[7];case 9:return[4,n.renderTemplates(this.elseTemplates,e,r)];case 10:return t.sent(),[2]}})}},Wr={parse:function(t,e){var r=this.liquid.parser.parseStream(e);r.on("token",function(t){"endcomment"===t.name&&r.stop()}).on("end",function(){throw new Error("tag ".concat(t.getText()," not closed"))}),r.start()}};(Qr=Ur=Ur||{})[Qr.OUTPUT=0]="OUTPUT",Qr[Qr.STORE=1]="STORE";var Yr=Ur,Jr={parseFilePath:Gr,renderFilePath:Zr,parse:function(t){var e=t.args,r=new kr(e,this.liquid.options.operatorsTrie);for(this.file=this.parseFilePath(r,this.liquid),this.currentFile=t.file;!r.end();){r.skipBlank();var n=r.p,i=r.readIdentifier();if(("with"===i.content||"for"===i.content)&&(r.skipBlank(),":"!==r.peek())){var o=r.readValue();if(o){var s=r.p,a=void 0;"as"===r.readIdentifier().content?a=r.readIdentifier():r.p=s,this[i.content]={value:o,alias:a&&a.content},r.skipBlank(),","===r.peek()&&r.advance();continue}}r.p=n;break}this.hash=new Er(r.remaining())},render:function(e,r){var n,i,o,s,a,u,c,l,h,p,f,d,v,g,y,m,w,b,T,k;return q(this,function(t){switch(t.label){case 0:return i=(n=this).liquid,o=n.hash,[4,this.renderFilePath(this.file,e,i)];case 1:return Jt(s=t.sent(),function(){return'illegal filename "'.concat(s,'"')}),a=new xn({},e.opts,{sync:e.sync,globals:e.globals,strictVariables:e.strictVariables}),u=a.bottom(),c=x,l=[u],[4,o.render(e)];case 2:if(c.apply(void 0,l.concat([t.sent()])),this.with&&(h=this.with,f=h.value,d=h.alias,u[d||s]=Le(f,e)),!this.for)return[3,12];p=this.for,f=p.value,d=p.alias,v=ot(v=Le(f,e)),u.forloop=new Vr(v.length,f.getText(),d),t.label=3;case 3:t.trys.push([3,9,10,11]),g=O(v),y=g.next(),t.label=4;case 4:return y.done?[3,8]:(m=y.value,u[d]=m,[4,i._parsePartialFile(s,a.sync,this.currentFile)]);case 5:return b=t.sent(),[4,i.renderer.renderTemplates(b,a,r)];case 6:t.sent(),u.forloop.next(),t.label=7;case 7:return y=g.next(),[3,4];case 8:return[3,11];case 9:return w=t.sent(),T={error:w},[3,11];case 10:try{y&&!y.done&&(k=g.return)&&k.call(g)}finally{if(T)throw T.error}return[7];case 11:return[3,15];case 12:return[4,i._parsePartialFile(s,a.sync,this.currentFile)];case 13:return b=t.sent(),[4,i.renderer.renderTemplates(b,a,r)];case 14:t.sent(),t.label=15;case 15:return[2]}})}};function Gr(t,e){if(e.options.dynamicPartials){var r=t.readValue();if(void 0===r)throw new TypeError('illegal argument "'.concat(t.input,'"'));return"none"===r.getText()?null:ie(r)?Xr(e.parse(Pe(r))):r}var n=w([],m(t.readFileNameTemplate(e.options)),!1),i=Xr(e.parser.parseTokens(n));return"none"===i?null:i}function Xr(t){return 1===t.length&&ee(t[0].token)?t[0].token.getContent():t}function Zr(t,e,r){return"string"==typeof t?t:Array.isArray(t)?r.renderer.renderTemplates(t,e):Le(t,e)}var tn,en={parseFilePath:Gr,renderFilePath:Zr,parse:function(t){var e=t.args,r=new kr(e,this.liquid.options.operatorsTrie);this.file=this.parseFilePath(r,this.liquid),this.currentFile=t.file;var n=r.p;"with"===r.readIdentifier().content?(r.skipBlank(),":"!==r.peek()?this.withVar=r.readValue():r.p=n):r.p=n,this.hash=new Er(r.remaining(),this.liquid.options.jekyllInclude)},render:function(e,r){var n,i,o,s,a,u,c,l,h;return q(this,function(t){switch(t.label){case 0:return i=(n=this).liquid,o=n.hash,s=n.withVar,a=i.renderer,[4,this.renderFilePath(this.file,e,i)];case 1:return Jt(u=t.sent(),function(){return'illegal filename "'.concat(u,'"')}),c=e.saveRegister("blocks","blockMode"),e.setRegister("blocks",{}),e.setRegister("blockMode",Yr.OUTPUT),[4,o.render(e)];case 2:return l=t.sent(),s&&(l[u]=Le(s,e)),[4,i._parsePartialFile(u,e.sync,this.currentFile)];case 3:return h=t.sent(),e.push(e.opts.jekyllInclude?{include:l}:l),[4,a.renderTemplates(h,e,r)];case 4:return t.sent(),e.pop(),e.restoreRegister(c),[2]}})}},rn={parse:function(t){var e=new kr(t.args,this.liquid.options.operatorsTrie);this.variable=e.readIdentifier().content},render:function(t,e){var r=t.environments;d(r[this.variable])||(r[this.variable]=0),e.write(h(--r[this.variable]))}},nn={parse:function(t){var e=new kr(t.args,this.liquid.options.operatorsTrie),r=e.readValue();for(e.skipBlank(),this.candidates=[],r&&(":"===e.peek()?(this.group=r,e.advance()):this.candidates.push(r));!e.end();){var n=e.readValue();n&&this.candidates.push(n),e.readTo(",")}Jt(this.candidates.length,function(){return"empty candidates: ".concat(t.getText())})},render:function(t,e){var r=Le(this.group,t),n="cycle:".concat(r,":")+this.candidates.join(","),i=t.getRegister("cycle"),o=i[n];void 0===o&&(o=i[n]=0);var s=this.candidates[o];o=(o+1)%this.candidates.length,i[n]=o;var a=Le(s,t);e.write(a)}},on={parse:function(t,e){var r,n=this;this.branches=[],this.elseTemplates=[],this.liquid.parser.parseStream(e).on("start",function(){return n.branches.push({predicate:new Mr(t.args,n.liquid),templates:r=[]})}).on("tag:elsif",function(t){return n.branches.push({predicate:new Mr(t.args,n.liquid),templates:r=[]})}).on("tag:else",function(){return r=n.elseTemplates}).on("tag:endif",function(){this.stop()}).on("template",function(t){return r.push(t)}).on("end",function(){throw new Error("tag ".concat(t.getText()," not closed"))}).start()},render:function(e,r){var n,i,o,s,a,u,c,l,h;return q(this,function(t){switch(t.label){case 0:n=this.liquid.renderer,t.label=1;case 1:t.trys.push([1,7,8,9]),i=O(this.branches),o=i.next(),t.label=2;case 2:return o.done?[3,6]:(s=o.value,a=s.predicate,u=s.templates,[4,a.value(e,e.opts.lenientIf)]);case 3:return z(t.sent(),e)?[4,n.renderTemplates(u,e,r)]:[3,5];case 4:return t.sent(),[2];case 5:return o=i.next(),[3,2];case 6:return[3,9];case 7:return c=t.sent(),l={error:c},[3,9];case 8:try{o&&!o.done&&(h=i.return)&&h.call(i)}finally{if(l)throw l.error}return[7];case 9:return[4,n.renderTemplates(this.elseTemplates,e,r)];case 10:return t.sent(),[2]}})}},sn={parse:function(t){var e=new kr(t.args,this.liquid.options.operatorsTrie);this.variable=e.readIdentifier().content},render:function(t,e){var r=t.environments;d(r[this.variable])||(r[this.variable]=0);var n=r[this.variable];r[this.variable]++,e.write(h(n))}},an={parseFilePath:Gr,renderFilePath:Zr,parse:function(t,e){var r=new kr(t.args,this.liquid.options.operatorsTrie);this.file=this.parseFilePath(r,this.liquid),this.currentFile=t.file,this.hash=new Er(r.remaining()),this.tpls=this.liquid.parser.parseTokens(e)},render:function(e,r){var n,i,o,s,a,u,c,l,h,p,f;return q(this,function(t){switch(t.label){case 0:return i=(n=this).liquid,o=n.hash,s=n.file,a=i.renderer,null!==s?[3,2]:(e.setRegister("blockMode",Yr.OUTPUT),[4,a.renderTemplates(this.tpls,e,r)]);case 1:return t.sent(),[2];case 2:return[4,this.renderFilePath(this.file,e,i)];case 3:return Jt(u=t.sent(),function(){return'illegal filename "'.concat(u,'"')}),[4,i._parseLayoutFile(u,e.sync,this.currentFile)];case 4:return c=t.sent(),e.setRegister("blockMode",Yr.STORE),[4,a.renderTemplates(this.tpls,e)];case 5:return l=t.sent(),void 0===(h=e.getRegister("blocks"))[""]&&(h[""]=function(t,e){return e.write(l)}),e.setRegister("blockMode",Yr.OUTPUT),f=(p=e).push,[4,o.render(e)];case 6:return f.apply(p,[t.sent()]),[4,a.renderTemplates(c,e,r)];case 7:return t.sent(),e.pop(),[2]}})}},un=(t(cn,tn=s),cn.prototype.super=function(){return this.superBlockRender()},cn);function cn(t){void 0===t&&(t=function(){return""});var e=tn.call(this)||this;return e.superBlockRender=t,e}var ln,hn={parse:function(t,e){var r=this,n=/\w+/.exec(t.args);this.block=n?n[0]:"",this.tpls=[],this.liquid.parser.parseStream(e).on("tag:endblock",function(){this.stop()}).on("template",function(t){return r.tpls.push(t)}).on("end",function(){throw new Error("tag ".concat(t.getText()," not closed"))}).start()},render:function(e,r){var n;return q(this,function(t){switch(t.label){case 0:return n=this.getBlockRender(e),e.getRegister("blockMode")!==Yr.STORE?[3,1]:(e.getRegister("blocks")[this.block]=n,[3,3]);case 1:return[4,n(new un,r)];case 2:t.sent(),t.label=3;case 3:return[2]}})},getBlockRender:function(n){function r(e,r){return q(this,function(t){switch(t.label){case 0:return n.push({block:e}),[4,i.renderer.renderTemplates(o,n,r)];case 1:return t.sent(),n.pop(),[2]}})}var i=this.liquid,o=this.tpls,s=n.getRegister("blocks")[this.block];return s?function(t,e){return s(new un(function(){return r(t,e)}),e)}:r}},pn={parse:function(t,e){var r=this;this.tokens=[];var n=this.liquid.parser.parseStream(e);n.on("token",function(t){"endraw"===t.name?n.stop():r.tokens.push(t)}).on("end",function(){throw new Error("tag ".concat(t.getText()," not closed"))}),n.start()},render:function(){return this.tokens.map(function(t){return t.getText()}).join("")}},fn=(t(dn,ln=Vr),dn.prototype.row=function(){return Math.floor(this.i/this.cols)+1},dn.prototype.col0=function(){return this.i%this.cols},dn.prototype.col=function(){return this.col0()+1},dn.prototype.col_first=function(){return 0===this.col0()},dn.prototype.col_last=function(){return this.col()===this.cols},dn);function dn(t,e,r,n){var i=ln.call(this,t,r,n)||this;return i.length=t,i.cols=e,i}var vn={assign:zr,for:Hr,capture:Kr,case:$r,comment:Wr,include:en,render:Jr,decrement:rn,increment:sn,cycle:nn,if:on,layout:an,block:hn,raw:pn,tablerow:{parse:function(t,e){var r=this,n=new kr(t.args,this.liquid.options.operatorsTrie),i=n.readIdentifier();n.skipBlank();var o,s=n.readIdentifier();Jt(s&&"in"===s.content,function(){return"illegal tag: ".concat(t.getText())}),this.variable=i.content,this.collection=n.readValue(),this.hash=new Er(n.remaining()),this.templates=[];var a=this.liquid.parser.parseStream(e).on("start",function(){return o=r.templates}).on("tag:endtablerow",function(){return a.stop()}).on("template",function(t){return o.push(t)}).on("end",function(){throw new Error("tag ".concat(t.getText()," not closed"))});a.start()},render:function(e,r){var n,i,o,s,a,u,c,l,h,p;return q(this,function(t){switch(t.label){case 0:return i=ot,[4,Le(this.collection,e)];case 1:return n=i.apply(void 0,[t.sent()]),[4,this.hash.render(e)];case 2:o=t.sent(),s=o.offset||0,a=void 0===o.limit?n.length:o.limit,n=n.slice(s,s+a),u=o.cols||n.length,c=this.liquid.renderer,l=new fn(n.length,u,this.collection.getText(),this.variable),h={tablerowloop:l},e.push(h),p=0,t.label=3;case 3:return p<n.length?(h[this.variable]=n[p],0===l.col0()&&(1!==l.row()&&r.write("</tr>"),r.write('<tr class="row'.concat(l.row(),'">'))),r.write('<td class="col'.concat(l.col(),'">')),[4,c.renderTemplates(this.templates,e,r)]):[3,6];case 4:t.sent(),r.write("</td>"),t.label=5;case 5:return p++,l.next(),[3,3];case 6:return n.length&&r.write("</tr>"),e.pop(),[2]}})}},unless:{parse:function(t,e){var r,n=this;this.branches=[],this.elseTemplates=[],this.liquid.parser.parseStream(e).on("start",function(){return n.branches.push({predicate:new Mr(t.args,n.liquid),test:V,templates:r=[]})}).on("tag:elsif",function(t){return n.branches.push({predicate:new Mr(t.args,n.liquid),test:z,templates:r=[]})}).on("tag:else",function(){return r=n.elseTemplates}).on("tag:endunless",function(){this.stop()}).on("template",function(t){return r.push(t)}).on("end",function(){throw new Error("tag ".concat(t.getText()," not closed"))}).start()},render:function(e,r){var n,i,o,s,a,u,c,l,h,p,f;return q(this,function(t){switch(t.label){case 0:n=this.liquid.renderer,t.label=1;case 1:t.trys.push([1,7,8,9]),i=O(this.branches),o=i.next(),t.label=2;case 2:return o.done?[3,6]:(s=o.value,a=s.predicate,u=s.test,c=s.templates,[4,a.value(e,e.opts.lenientIf)]);case 3:return l=t.sent(),u(l,e)?[4,n.renderTemplates(c,e,r)]:[3,5];case 4:return t.sent(),[2];case 5:return o=i.next(),[3,2];case 6:return[3,9];case 7:return h=t.sent(),p={error:h},[3,9];case 8:try{o&&!o.done&&(f=i.return)&&f.call(i)}finally{if(p)throw p.error}return[7];case 9:return[4,n.renderTemplates(this.elseTemplates,e,r)];case 10:return t.sent(),[2]}})}},break:{render:function(t,e){e.break=!0}},continue:{render:function(t,e){e.continue=!0}},echo:{parse:function(t){this.value=new Mr(t.args,this.liquid)},render:function(e,r){var n;return q(this,function(t){switch(t.label){case 0:return[4,this.value.value(e,!1)];case 1:return n=t.sent(),r.write(n),[2]}})}},liquid:{parse:function(t){var e=new kr(t.args,this.liquid.options.operatorsTrie).readLiquidTagTokens(this.liquid.options);this.tpls=this.liquid.parser.parseTokens(e)},render:function(e,r){return q(this,function(t){switch(t.label){case 0:return[4,this.liquid.renderer.renderTemplates(this.tpls,e,r)];case 1:return t.sent(),[2]}})}},"#":{parse:function(t,e){if(-1!==t.args.search(/\n\s*[^#\s]/g))throw new Error("every line of an inline comment must start with a '#' character")}}},gn=Object.freeze({__proto__:null,default:vn}),yn=new Map;y(Xt,function(t,e){yn.set(E(e),t)});var mn={root:["."],layouts:["."],partials:["."],relativeReference:!0,jekyllInclude:!1,cache:void 0,extname:"",fs:A,dynamicPartials:!0,jsTruthy:!1,trimTagRight:!1,trimTagLeft:!1,trimOutputRight:!1,trimOutputLeft:!1,greedy:!0,tagDelimiterLeft:"{%",tagDelimiterRight:"%}",outputDelimiterLeft:"{{",outputDelimiterRight:"}}",preserveTimezones:!1,strictFilters:!1,strictVariables:!1,ownPropertyOnly:!1,lenientIf:!1,globals:{},keepOutputType:!1,operators:B,operatorsTrie:Q(B)};function wn(t){if(t.hasOwnProperty("operators")&&(t.operatorsTrie=Q(t.operators)),t.hasOwnProperty("root")&&(t.hasOwnProperty("partials")||(t.partials=t.root),t.hasOwnProperty("layouts")||(t.layouts=t.root)),t.hasOwnProperty("cache")){var e=void 0;e="number"==typeof t.cache?0<t.cache?new N(t.cache):void 0:"object"==typeof t.cache?t.cache:t.cache?new N(1024):void 0,t.cache=e}return!(t=x(x(x({},mn),t.jekyllInclude?{dynamicPartials:!1}:{}),t)).fs.dirname&&t.relativeReference&&(console.warn("[LiquidJS] `fs.dirname` is required for relativeReference, set relativeReference to `false` to suppress this warning, or provide implementation for `fs.dirname`"),t.relativeReference=!1),t.root=bn(t.root),t.partials=bn(t.partials),t.layouts=bn(t.layouts),t.outputEscape=t.outputEscape&&function(t){{if(u(t)){var e=yn.get(t);return Jt(c(e),'filter "'.concat(t,'" not found')),e}return Jt(c(t),"`outputEscape` need to be of type string or function"),t}}(t.outputEscape),t}function bn(t){var e=[];return g(t)&&(e=t),u(t)&&(e=[t]),e}var Tn,kn,xn=(qn.prototype.getRegister=function(t){return this.registers[t]=this.registers[t]||{}},qn.prototype.setRegister=function(t,e){return this.registers[t]=e},qn.prototype.saveRegister=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return t.map(function(t){return[t,e.getRegister(t)]})},qn.prototype.restoreRegister=function(t){var i=this;return t.forEach(function(t){var e=m(t,2),r=e[0],n=e[1];return i.setRegister(r,n)})},qn.prototype.getAll=function(){return w([this.globals,this.environments],m(this.scopes),!1).reduce(function(t,e){return x(t,e)},{})},qn.prototype.get=function(t){var e=this.findScope(t[0]);return this.getFromScope(e,t)},qn.prototype.getFromScope=function(t,n){var i=this;return u(n)&&(n=n.split(".")),n.reduce(function(t,e,r){if(v(t=function(t,e,r){if(v(t))return t;if(g(t=function t(e){return e&&c(e.toLiquid)?t(e.toLiquid()):e}(t))&&e<0)return t[t.length+ +e];var n=function(t,e,r){return r&&!Object.hasOwnProperty.call(t,e)?void 0:t[e]}(t,e,r);return void 0===n&&t instanceof s?t.liquidMethodMissing(e):c(n)?n.call(t):"size"===e?function(t){return t.hasOwnProperty("size")||void 0!==t.size?t.size:g(t)||u(t)?t.length:"object"==typeof t?Object.keys(t).length:void 0}(t):"first"===e?function(t){return g(t)?t[0]:t.first}(t):"last"===e?function(t){return g(t)?t[t.length-1]:t.last}(t):n}(t,e,i.opts.ownPropertyOnly))&&i.strictVariables)throw new Ut(n.slice(0,r+1).join("."));return t},t)},qn.prototype.push=function(t){return this.scopes.push(t)},qn.prototype.pop=function(){return this.scopes.pop()},qn.prototype.bottom=function(){return this.scopes[0]},qn.prototype.findScope=function(t){for(var e=this.scopes.length-1;0<=e;e--){var r=this.scopes[e];if(t in r)return r}return t in this.environments?this.environments:this.globals},qn);function qn(t,e,r){var n,i;void 0===t&&(t={}),void 0===e&&(e=mn),void 0===r&&(r={}),this.scopes=[{}],this.registers={},this.sync=!!r.sync,this.opts=e,this.globals=null!==(n=r.globals)&&void 0!==n?n:e.globals,this.environments=t,this.strictVariables=null!==(i=r.strictVariables)&&void 0!==i?i:this.opts.strictVariables}(kn=Tn=Tn||{}).Partials="partials",kn.Layouts="layouts",kn.Root="root";var On=(Sn.prototype.lookup=function(e,r,n,i){var o,s,a,u,c,l,h,p,f;return q(this,function(t){switch(t.label){case 0:o=this.options.fs,s=this.options[r],t.label=1;case 1:t.trys.push([1,8,9,10]),a=O(this.candidates(e,s,i,r!==Tn.Root)),u=a.next(),t.label=2;case 2:return u.done?[3,7]:(c=u.value,n?(l=o.existsSync(c),[3,5]):[3,3]);case 3:return[4,o.exists(c)];case 4:l=t.sent(),t.label=5;case 5:if(l)return[2,c];t.label=6;case 6:return u=a.next(),[3,2];case 7:return[3,10];case 8:return h=t.sent(),p={error:h},[3,10];case 9:try{u&&!u.done&&(f=a.return)&&f.call(a)}finally{if(p)throw p.error}return[7];case 10:throw this.lookupError(e,s)}})},Sn.prototype.candidates=function(e,r,n,i){var o,s,a,u,c,l,h,p,f,d,v,g,y,m,w,b;return q(this,function(t){switch(t.label){case 0:if(o=this.options,s=o.fs,a=o.extname,!this.shouldLoadRelative(e)||!n)return[3,8];d=s.resolve(this.dirname(n),e,a),t.label=1;case 1:t.trys.push([1,6,7,8]),u=O(r),c=u.next(),t.label=2;case 2:return c.done?[3,5]:(f=c.value,i&&!this.contains(f,d)?[3,4]:[4,d]);case 3:return t.sent(),[3,5];case 4:return c=u.next(),[3,2];case 5:return[3,8];case 6:return l=t.sent(),y={error:l},[3,8];case 7:try{c&&!c.done&&(m=u.return)&&m.call(u)}finally{if(y)throw y.error}return[7];case 8:t.trys.push([8,13,14,15]),h=O(r),p=h.next(),t.label=9;case 9:return p.done?[3,12]:(f=p.value,d=s.resolve(f,e,a),i&&!this.contains(f,d)?[3,11]:[4,d]);case 10:t.sent(),t.label=11;case 11:return p=h.next(),[3,9];case 12:return[3,15];case 13:return v=t.sent(),w={error:v},[3,15];case 14:try{p&&!p.done&&(b=h.return)&&b.call(h)}finally{if(w)throw w.error}return[7];case 15:return void 0===s.fallback?[3,17]:void 0===(g=s.fallback(e))?[3,17]:[4,g];case 16:t.sent(),t.label=17;case 17:return[2]}})},Sn.prototype.dirname=function(t){var e=this.options.fs;return Jt(e.dirname,"`fs.dirname` is required for relative reference"),e.dirname(t)},Sn.prototype.lookupError=function(t,e){var r=new Error("ENOENT");return r.message='ENOENT: Failed to lookup "'.concat(t,'" in "').concat(e,'"'),r.code="ENOENT",r},Sn);function Sn(t){if((this.options=t).relativeReference){var e=t.fs.sep;Jt(e,"`fs.sep` is required for relative reference");var r=new RegExp(["."+e,".."+e,"./","../"].map(function(t){return function(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}(t)}).join("|"));this.shouldLoadRelative=function(t){return r.test(t)}}else this.shouldLoadRelative=function(t){return!1};this.contains=this.options.fs.contains||function(){return!0}}var Rn=(Fn.prototype.write=function(t){this.buffer+=h(t)},Fn);function Fn(){this.buffer=""}var En=function(){throw this.buffer="",this.stream=null,new Error("streaming not supported in browser")},Ln=(Pn.prototype.write=function(t){"string"!=typeof(t=f(t))&&""===this.buffer?this.buffer=t:this.buffer=h(this.buffer)+h(t)},Pn);function Pn(){this.buffer=""}var Dn=(Mn.prototype.renderTemplatesToNodeStream=function(t,e){var r=this,n=new En;return Promise.resolve().then(function(){return _r(r.renderTemplates(t,e,n))}).then(function(){return n.end()},function(t){return n.error(t)}),n.stream},Mn.prototype.renderTemplates=function(e,r,n){var i,o,s,a,u,c,l,h;return q(this,function(t){switch(t.label){case 0:n=n||(r.opts.keepOutputType?new Ln:new Rn),t.label=1;case 1:t.trys.push([1,8,9,10]),i=O(e),o=i.next(),t.label=2;case 2:if(o.done)return[3,7];s=o.value,t.label=3;case 3:return t.trys.push([3,5,,6]),[4,s.render(r,n)];case 4:return(a=t.sent())&&n.write(a),n.break||n.continue?[3,7]:[3,6];case 5:throw u=t.sent(),zt.is(u)?u:new zt(u,s);case 6:return o=i.next(),[3,2];case 7:return[3,10];case 8:return c=t.sent(),l={error:c},[3,10];case 9:try{o&&!o.done&&(h=i.return)&&h.call(i)}finally{if(l)throw l.error}return[7];case 10:return[2,n.buffer]}})},Mn);function Mn(){}function Nn(t){this.token=t}var _n,jn=(t(An,_n=Nn),An.prototype.render=function(e,r){var n,i;return q(this,function(t){switch(t.label){case 0:return[4,new Er(this.token.args).render(e)];case 1:return n=t.sent(),c((i=this.impl).render)?[4,i.render(e,r,n)]:[3,3];case 2:return[2,t.sent()];case 3:return[2]}})},An);function An(t,e,r){var n=_n.call(this,t)||this;n.name=t.name;var i=r.tags.get(t.name);return n.impl=Object.create(i),n.impl.liquid=r,n.impl.parse&&n.impl.parse(t,e),n}var In,zn=(t(Vn,In=Nn),Vn.prototype.render=function(e,r){var n;return q(this,function(t){switch(t.label){case 0:return[4,this.value.value(e,!1)];case 1:return n=t.sent(),r.write(n),[2]}})},Vn);function Vn(t,e){var r=In.call(this,t)||this;r.value=new Mr(t.content,e);var n=r.value.filters,i=e.options.outputEscape;return n.length&&"raw"===n[n.length-1].name?n.pop():i&&n.push(new Pr(toString.call(i),i,[],e)),r}var Bn,Cn=(t(Hn,Bn=Nn),Hn.prototype.render=function(t,e){return q(this,function(t){return e.write(this.str),[2]})},Hn);function Hn(t){var e=Bn.call(this,t)||this;return e.str=t.getContent(),e}var Kn=(Un.prototype.parse=function(t,e){var r=new kr(t,this.liquid.options.operatorsTrie,e).readTopLevelTokens(this.liquid.options);return this.parseTokens(r)},Un.prototype.parseTokens=function(t){for(var e,r=[];e=t.shift();)r.push(this.parseToken(e,t));return r},Un.prototype.parseToken=function(e,t){try{return ne(e)?new jn(e,t,this.liquid):re(e)?new zn(e,this.liquid):new Cn(e)}catch(t){throw new jt(t,e)}},Un.prototype.parseStream=function(t){var r=this;return new Rr(t,function(t,e){return r.parseToken(t,e)})},Un.prototype._parseFileCached=function(e,r,n,i){var o,s,a,u,c,l,h;return void 0===n&&(n=Tn.Root),q(this,function(t){switch(t.label){case 0:return o=this.cache,s=this.loader.shouldLoadRelative(e)?i+","+e:n+":"+e,[4,o.read(s)];case 1:return(a=t.sent())?[2,a]:(u=this._parseFile(e,r,n,i),r?[4,u]:[3,3]);case 2:return l=t.sent(),[3,4];case 3:l=_r(u),t.label=4;case 4:c=l,o.write(s,c),t.label=5;case 5:return t.trys.push([5,7,,8]),[4,c];case 6:return[2,t.sent()];case 7:throw h=t.sent(),o.remove(s),h;case 8:return[2]}})},Un.prototype._parseFile=function(e,r,n,i){var o,s,a,u;return void 0===n&&(n=Tn.Root),q(this,function(t){switch(t.label){case 0:return[4,this.loader.lookup(e,n,r,i)];case 1:return o=t.sent(),a=(s=this.liquid).parse,r?(u=this.fs.readFileSync(o),[3,4]):[3,2];case 2:return[4,this.fs.readFile(o)];case 3:u=t.sent(),t.label=4;case 4:return[2,a.apply(s,[u,o])]}})},Un);function Un(t){this.liquid=t,this.cache=this.liquid.options.cache,this.fs=this.liquid.options.fs,this.parseFile=this.cache?this._parseFileCached:this._parseFile,this.loader=new On(this.liquid.options)}var Qn=($n.prototype.get=function(t){var e=this.impls[t];return Jt(e,function(){return'tag "'.concat(t,'" not found')}),e},$n.prototype.set=function(t,e){this.impls[t]=e},$n);function $n(){this.impls={}}var Wn=(Yn.prototype.get=function(t){var e=this.impls[t];return Jt(e||!this.strictFilters,function(){return"undefined filter: ".concat(t)}),e},Yn.prototype.set=function(t,e){this.impls[t]=e},Yn.prototype.create=function(t,e){return new Pr(t,this.get(t),e,this.liquid)},Yn);function Yn(t,e){this.strictFilters=t,this.liquid=e,this.impls={}}var Jn=(Gn.prototype.parse=function(t,e){return this.parser.parse(t,e)},Gn.prototype._render=function(t,e,r){var n=new xn(e,this.options,r);return this.renderer.renderTemplates(t,n)},Gn.prototype.render=function(e,r,n){return o(this,void 0,void 0,function(){return q(this,function(t){return[2,_r(this._render(e,r,x(x({},n),{sync:!1})))]})})},Gn.prototype.renderSync=function(t,e,r){return jr(this._render(t,e,x(x({},r),{sync:!0})))},Gn.prototype.renderToNodeStream=function(t,e,r){void 0===r&&(r={});var n=new xn(e,this.options,r);return this.renderer.renderTemplatesToNodeStream(t,n)},Gn.prototype._parseAndRender=function(t,e,r){var n=this.parse(t);return this._render(n,e,r)},Gn.prototype.parseAndRender=function(e,r,n){return o(this,void 0,void 0,function(){return q(this,function(t){return[2,_r(this._parseAndRender(e,r,x(x({},n),{sync:!1})))]})})},Gn.prototype.parseAndRenderSync=function(t,e,r){return jr(this._parseAndRender(t,e,x(x({},r),{sync:!0})))},Gn.prototype._parsePartialFile=function(t,e,r){return this.parser.parseFile(t,e,Tn.Partials,r)},Gn.prototype._parseLayoutFile=function(t,e,r){return this.parser.parseFile(t,e,Tn.Layouts,r)},Gn.prototype.parseFile=function(e){return o(this,void 0,void 0,function(){return q(this,function(t){return[2,_r(this.parser.parseFile(e,!1))]})})},Gn.prototype.parseFileSync=function(t){return jr(this.parser.parseFile(t,!0))},Gn.prototype.renderFile=function(r,n,i){return o(this,void 0,void 0,function(){var e;return q(this,function(t){switch(t.label){case 0:return[4,this.parseFile(r)];case 1:return e=t.sent(),[2,this.render(e,n,i)]}})})},Gn.prototype.renderFileSync=function(t,e,r){var n=this.parseFileSync(t);return this.renderSync(n,e,r)},Gn.prototype.renderFileToNodeStream=function(r,n,i){return o(this,void 0,void 0,function(){var e;return q(this,function(t){switch(t.label){case 0:return[4,this.parseFile(r)];case 1:return e=t.sent(),[2,this.renderToNodeStream(e,n,i)]}})})},Gn.prototype._evalValue=function(t,e){return new Mr(t,this).value(e,!1)},Gn.prototype.evalValue=function(e,r){return o(this,void 0,void 0,function(){return q(this,function(t){return[2,_r(this._evalValue(e,r))]})})},Gn.prototype.evalValueSync=function(t,e){return jr(this._evalValue(t,e))},Gn.prototype.registerFilter=function(t,e){this.filters.set(t,e)},Gn.prototype.registerTag=function(t,e){this.tags.set(t,e)},Gn.prototype.plugin=function(t){return t.call(this,Gn)},Gn.prototype.express=function(){var a=this,u=!0;return function(t,e,r){var n,i,o;if(u){u=!1;var s=bn(this.root);(n=a.options.root).unshift.apply(n,w([],m(s),!1)),(i=a.options.layouts).unshift.apply(i,w([],m(s),!1)),(o=a.options.partials).unshift.apply(o,w([],m(s),!1))}a.renderFile(t,e).then(function(t){return r(null,t)},r)}},Gn);function Gn(t){var r=this;void 0===t&&(t={}),this.options=wn(t),this.parser=new Kn(this),this.renderer=new Dn,this.filters=new Wn(this.options.strictFilters,this),this.tags=new Qn,y(vn,function(t,e){return r.registerTag(E(e),t)}),y(Xt,function(t,e){return r.registerFilter(E(e),t)})}p.AssertionError=Wt,p.Context=xn,p.Drop=s,p.Expression=Fe,p.Hash=Er,p.InternalUndefinedVariableError=Ut,p.Liquid=Jn,p.LiquidError=Lt,p.ParseError=jt,p.ParseStream=Rr,p.RenderError=zt,p.TagToken=Or,p.TimezoneDate=St,p.Token=De,p.TokenizationError=Mt,p.Tokenizer=kr,p.TypeGuards=pe,p.UndefinedVariableError=Ct,p.Value=Mr,p.assert=Jt,p.createTrie=Q,p.defaultOperators=B,p.evalQuotedToken=Pe,p.evalToken=Le,p.filters=Xt,p.isFalsy=V,p.isTruthy=z,p.tags=gn,p.toPromise=_r,p.toThenable=Ir,p.toValue=f,p.version="9.39.1",Object.defineProperty(p,"__esModule",{value:!0})});
//# sourceMappingURL=liquid.browser.min.js.map
